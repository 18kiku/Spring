<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "..//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CartDAO">
	<resultMap type="cart" id="cartResult">
		<result property="cart_id" column="cart_id"/>
		<result property="orderer_id" column="orderer_id"/>
		<result property="product_id" column="product_id"/>
		<result property="order_quantity" column="order_quantity"/>
	</resultMap>
	
	<insert id="insertCart">
		<![CDATA[
		insert into cart(cart_id, orderer_id, product_id, order_quantity) 
		values(SEQ_CART.nextval, #{orderer_id}, #{product_id}, #{order_quantity})
		]]>
	</insert>
	
	<select id="checkCart" resultType="int">
		<![CDATA[
		select count(*) from cart
		where orderer_id = #{orderer_id} 
		and product_id = #{product_id}
		]]>
	</select>
	
	<update id="updateCart">
		<![CDATA[
		update cart set order_quantity=#{order_quantity} 
		where product_id=#{product_id}
		and orderer_id=#{orderer_id}
		]]>
	</update>
	
	<delete id="deleteCart">
		<![CDATA[
		delete from cart where cart_id=#{cart_id}
		]]>
	</delete>
	
	<delete id="deleteCartAll">
		<![CDATA[
		delete from cart where orderer_id=#{orderer_id}
		]]>
	</delete>
	
	<select id="getCart" resultMap="cartResult">
		<![CDATA[
		select * from cart where cart_id=#{cart_id}
		]]>
	</select>
	
	<select id="getCartList" resultMap="cartResult">
		<![CDATA[
		select * from cart join product
		on cart.product_id = product.product_id
		where orderer_id = #{orderer_id}
		order by cart_id desc
		]]>
	</select>
	
	<select id="getCartCount" resultType="int">
		<![CDATA[
		select count(*) from cart
		where orderer_id = #{orderer_id}
		]]>
	</select>
</mapper>					